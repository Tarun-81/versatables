<?php
/** @var $block \Cryozonic\StripeExpress\Block\Button */
?>

<?php if ($block->isEnabled()) : ?>
    <div id="payment-request-button" class="payment-request-button">&nbsp;</div>
    <script>
        require(['jquery', 'cryozonic_stripeexpress'], function(jQuery, stripeexpress) {
            jQuery(document).ready(function() {
                stripeexpress.initStripeExpress('#payment-request-button', '<?php echo $block->getPublishableKey(); ?>', <?php echo \Zend_Json::encode($block->getApplePayParams()); ?>, <?php echo \Zend_Json::encode($block->getButtonConfig()); ?>, function (paymentRequestButton, paymentRequest, params, prButton) {
                    stripeexpress.initCartWidget(paymentRequestButton, paymentRequest, params, prButton);
                });
            });
        });
    </script>
<?php endif; ?>
